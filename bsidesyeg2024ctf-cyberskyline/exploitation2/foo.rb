require 'openssl'
require 'base64'

$data = "ekiJZkuVbZFmpqarq3vvVw=="
$data2 = "zHfKmf{W"

def encrypt(plaintext)
  cipher = OpenSSL::Cipher::AES.new(128, :ECB).encrypt

  cipher.key = 'CatsAtTheMansion'

  encrypted = cipher.update(plaintext) + cipher.final
  return encrypted
end

def decrypt(ciphertext)
  cipher = OpenSSL::Cipher::AES.new(128, :ECB).decrypt
  cipher.key = 'CatsAtTheMansion'
  decrypted = cipher.update(ciphertext) + cipher.final
  return decrypted
end

def main()
  puts "What is the passcode?"
  input = gets.chomp
  res =  encrypt(input)
  if res == Base64.decode64($data)
    puts "Congrats"
  else
    puts "Try again"
  end
end

puts decrypt(Base64.decode64($data))

